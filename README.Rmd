---
title: "obpg"
output: github_document
---

Access OPeNDAP [OBPG](https://oceancolor.gsfc.nasa.gov/) data from R.

This package provides simple tools for accessing most of the offerings found [here](https://oceandata.sci.gsfc.nasa.gov/opendap/).  Frankly, this package leverages OBPG's excellent filename standards with some assumptions about the organizational heirarchy on the server-side.  If you need a more robust solution then consider using the [thredds](https://github.com/BigelowLab/thredds) package to navigate the catalog. Use `thredds` to navigate the server catalog to find your desired product, then you can use this package to open the product as an OPeNDAP resource.

## Requirements

+ [R v4.1+](https://www.r-project.org/)

Packages from CRAN:

+ [rlang](https://CRAN.R-project.org/package=rlang)
+ [httr](https://CRAN.R-project.org/package=httr)
+ [readr](https://CRAN.R-project.org/package=readr)
+ [dplyr](https://CRAN.R-project.org/package=httr)
+ [sf](https://CRAN.R-project.org/package=sf)
+ [stars](https://CRAN.R-project.org/package=stars)
+ [tidyr](https://CRAN.R-project.org/package=tidyr)
+ [tidync](https://CRAN.R-project.org/package=ncdf4)

## Installation

```
remotes::install_github("BigelowLab/obpg")
```

### Usage

This package provides utilties for the following...

+ Generate URLs for products

+ Open the OPeNDAP product resources and query the contents as a [tidync](https://github.com/ropensci/tidync) object.

+ Extract the data in whole or part (rectangular subset) as a [stars](https://r-spatial.github.io/stars/) object

+ Archive files (as GeoTIFF) in an informal database arrangement 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
suppressPackageStartupMessages({
  library(dplyr)
  library(sf)
  library(stars)
  library(obpg)
})
```

# Generate a URL

Generate a URL for a data product with `obpg_url()` which accepts a number of arguments specifying the mission, instrument date, period, resolution and the like.

```{r}
suppressPackageStartupMessages({
  library(obpg)
  library(tidync)
  library(dplyr)
})

url = obpg_url(date = "2024-12-18",
               mission = "SNPP", 
               instrument = "VIIRS",
               product = "SST.sst",
               period = "DAY",
               resolution = "9km")
dplyr::glimpse(url)
```



